float voronoise_2d_hash(vec2 A){return fract(1e4*sin(17.*A.x+A.y*0.1)*(0.1+abs(sin(A.y*13.+A.x))));}vec2 voronoise_2d_hash2d(vec2 A){return vec2(voronoise_2d_hash(A+vec2(0.5,0)),voronoise_2d_hash(A+vec2(0,0.5)));}float voronoise_2d(vec2 A,float B,float C){vec2 D=floor(A);vec2 E=fract(A);float F=1.-C;F=F*F;F=F*F;F=1.+63.*F;float G=0.;float H=0.;for(int I=-2;I<=2;I++){for(int J=-2;J<=2;J++){vec2 K=vec2(I,J);float L=voronoise_2d_hash(D+K);vec2 M=voronoise_2d_hash2d(D+K)*B;vec2 N=K-E+M;float O=dot(N,N);float P=pow(1.-smoothstep(0.,2.,sqrt(O)),F);G+=P*L;H+=P;}}return G/H;}float fractal_voronoise_2d(vec2 A,float B,float C,int Q){float R=0.;float S=0.;float T=1.;float U=1.;for(int V=0;V<10;V++){if(V>=Q){break;}R+=voronoise_2d(A*U,B,C)*T;S+=T;T*=.4;U*=2.5;}return R/S;}vec2 curl_voronoise_2d(vec2 A,float B,float C){const float W=0.01;float X=voronoise_2d(A,B,C);float I=voronoise_2d(A+vec2(W,0.),B,C);float J=voronoise_2d(A+vec2(0.,W),B,C);return normalize(vec2(X-I,X-J));}vec2 curl_fractal_voronoise_2d(vec2 A,float B,float C,int Q){const float W=0.01;float X=fractal_voronoise_2d(A,B,C,Q);float I=fractal_voronoise_2d(A+vec2(W,0.),B,C,Q);float J=fractal_voronoise_2d(A+vec2(0.,W),B,C,Q);return normalize(vec2(X-I,X-J));}