vec4 simplex_noise_3d_permute(vec4 A){return mod(((A*34.)+1.)*A,289.);}vec4 simplex_noise_3d_taylorInvSqrt(vec4 B){return 1.79284291400159-0.85373472095314*B;}float simplex_noise_3d(vec3 C){const vec2 D=vec2(1./6.,1./3.);const vec4 E=vec4(0.,0.5,1.,2.);vec3 F=floor(C+dot(C,D.yyy));vec3 G=C-F+dot(F,D.xxx);vec3 H=step(G.yzx,G.xyz);vec3 I=1.-H;vec3 J=min(H.xyz,I.zxy);vec3 K=max(H.xyz,I.zxy);vec3 L=G-J+1.*D.xxx;vec3 M=G-K+2.*D.xxx;vec3 N=G-1.+3.*D.xxx;F=mod(F,289.);vec4 O=simplex_noise_3d_permute(simplex_noise_3d_permute(simplex_noise_3d_permute(F.z+vec4(0.,J.z,K.z,1.))+F.y+vec4(0.,J.y,K.y,1.))+F.x+vec4(0.,J.x,K.x,1.));float P=1./7.;vec3 Q=P*E.wyz-E.xzx;vec4 R=O-49.*floor(O*Q.z*Q.z);vec4 S=floor(R*Q.z);vec4 T=floor(R-7.*S);vec4 A=S*Q.x+Q.yyyy;vec4 U=T*Q.x+Q.yyyy;vec4 V=1.-abs(A)-abs(U);vec4 W=vec4(A.xy,U.xy);vec4 X=vec4(A.zw,U.zw);vec4 Y=floor(W)*2.+1.;vec4 Z=floor(X)*2.+1.;vec4 a=-step(V,vec4(0.));vec4 b=W.xzyw+Y.xzyw*a.xxyy;vec4 c=X.xzyw+Z.xzyw*a.zzww;vec3 d=vec3(b.xy,V.x);vec3 e=vec3(b.zw,V.y);vec3 f=vec3(c.xy,V.z);vec3 g=vec3(c.zw,V.w);vec4 h=simplex_noise_3d_taylorInvSqrt(vec4(dot(d,d),dot(e,e),dot(f,f),dot(g,g)));d*=h.x;e*=h.y;f*=h.z;g*=h.w;vec4 i=max(0.6-vec4(dot(G,G),dot(L,L),dot(M,M),dot(N,N)),0.);i=i*i;return(42.*dot(i*i,vec4(dot(d,G),dot(e,L),dot(f,M),dot(g,N))))/2.+.5;}float fractal_simplex_noise_3d(vec3 O,int j){float k=0.;float l=0.;float m=1.;for(int n=0;n<10;n++){if(n>=j){break;}k+=simplex_noise_3d(O/m)*m;l+=m;m*=.5;}return k/l;}vec3 curl_simplex_noise_3d(vec3 O){const float o=0.01;float C=simplex_noise_3d(O);float A=simplex_noise_3d(O+vec3(o,0.,0.));float U=simplex_noise_3d(O+vec3(0.,o,0.));float p=simplex_noise_3d(O+vec3(0.,0.,o));return normalize(vec3(C-A,C-U,C-A));}vec3 curl_fractal_simplex_noise_3d(vec3 O,int j){const float o=0.01;float C=fractal_simplex_noise_3d(O,j);float A=fractal_simplex_noise_3d(O+vec3(o,0.,0.),j);float U=fractal_simplex_noise_3d(O+vec3(0.,o,0.),j);float p=fractal_simplex_noise_3d(O+vec3(0.,0.,o),j);return normalize(vec3(C-A,C-U,C-p));}