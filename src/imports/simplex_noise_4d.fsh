vec4 simplex_noise_4d_permute(vec4 A){return mod(((A*34.)+1.)*A,289.);}float simplex_noise_4d_permute(float A){return floor(mod(((A*34.)+1.)*A,289.));}vec4 simplex_noise_4d_taylorInvSqrt(vec4 B){return 1.79284291400159-0.85373472095314*B;}float simplex_noise_4d_taylorInvSqrt(float B){return 1.79284291400159-0.85373472095314*B;}vec4 simplex_noise_4d_grad(float C,vec4 D){const vec4 E=vec4(1.,1.,1.,-1.);vec4 F,G;F.xyz=floor(fract(vec3(C)*D.xyz)*7.)*D.z-1.;F.w=1.5-dot(abs(F.xyz),E.xyz);G=vec4(lessThan(F,vec4(0.)));F.xyz=F.xyz+(G.xyz*2.-1.)*G.www;return F;}float simplex_noise_4d(vec4 H){const vec2 I=vec2(0.138196601125010504,0.309016994374947451);vec4 J=floor(H+dot(H,I.yyyy));vec4 K=H-J+dot(J,I.xxxx);vec4 L;vec3 M=step(K.yzw,K.xxx);vec3 N=step(K.zww,K.yyz);L.x=M.x+M.y+M.z;L.yzw=1.-M;L.y+=N.x+N.y;L.zw+=1.-N.xy;L.z+=N.z;L.w+=1.-N.z;vec4 O=clamp(L,0.,1.);vec4 P=clamp(L-1.,0.,1.);vec4 Q=clamp(L-2.,0.,1.);vec4 R=K-Q+1.*I.xxxx;vec4 S=K-P+2.*I.xxxx;vec4 T=K-O+3.*I.xxxx;vec4 U=K-1.+4.*I.xxxx;J=mod(J,289.);float V=simplex_noise_4d_permute(simplex_noise_4d_permute(simplex_noise_4d_permute(simplex_noise_4d_permute(J.w)+J.z)+J.y)+J.x);vec4 W=simplex_noise_4d_permute(simplex_noise_4d_permute(simplex_noise_4d_permute(simplex_noise_4d_permute(J.w+vec4(Q.w,P.w,O.w,1.))+J.z+vec4(Q.z,P.z,O.z,1.))+J.y+vec4(Q.y,P.y,O.y,1.))+J.x+vec4(Q.x,P.x,O.x,1.));vec4 D=vec4(1./294.,1./49.,1./7.,0.);vec4 X=simplex_noise_4d_grad(V,D);vec4 Y=simplex_noise_4d_grad(W.x,D);vec4 Z=simplex_noise_4d_grad(W.y,D);vec4 a=simplex_noise_4d_grad(W.z,D);vec4 b=simplex_noise_4d_grad(W.w,D);vec4 c=simplex_noise_4d_taylorInvSqrt(vec4(dot(X,X),dot(Y,Y),dot(Z,Z),dot(a,a)));X*=c.x;Y*=c.y;Z*=c.z;a*=c.w;b*=simplex_noise_4d_taylorInvSqrt(dot(b,b));vec3 d=max(0.6-vec3(dot(K,K),dot(R,R),dot(S,S)),0.);vec2 e=max(0.6-vec2(dot(T,T),dot(U,U)),0.);d=d*d;e=e*e;return(49.*(dot(d*d,vec3(dot(X,K),dot(Y,R),dot(Z,S)))+dot(e*e,vec2(dot(a,T),dot(b,U)))))/2.+.5;}float fractal_simplex_noise_4d(vec4 F,int f){float g=0.;float h=0.;float i=1.;for(int j=0;j<10;j++){if(j>=f){break;}g+=simplex_noise_4d(F/i)*i;h+=i;i*=.5;}return g/h;}vec4 curl_simplex_noise_4d(vec4 F){const float k=0.01;float H=simplex_noise_4d(F);float A=simplex_noise_4d(F+vec4(k,0.,0.,0.));float l=simplex_noise_4d(F+vec4(0.,k,0.,0.));float m=simplex_noise_4d(F+vec4(0.,0.,k,0.));float n=simplex_noise_4d(F+vec4(0.,0.,0.,k));return normalize(vec4(H-A,H-l,H-A,H-n));}vec4 curl_fractal_simplex_noise_4d(vec4 F,int f){const float k=0.01;float H=fractal_simplex_noise_4d(F,f);float A=fractal_simplex_noise_4d(F+vec4(k,0.,0.,0.),f);float l=fractal_simplex_noise_4d(F+vec4(0.,k,0.,0.),f);float m=fractal_simplex_noise_4d(F+vec4(0.,0.,k,0.),f);float n=fractal_simplex_noise_4d(F+vec4(0.,0.,0.,k),f);return normalize(vec4(H-A,H-l,H-A,H-n));}