const float CLOVER_NOISE_2D_POINT_SPREAD=.3;const float CLOVER_NOISE_2D_PI=radians(180.);float clover_noise_2d_hash(vec2 A){return fract(1e4*sin(17.*A.x+A.y*0.1)*(0.1+abs(sin(A.y*13.+A.x))));}vec2 clover_noise_2d_offset(vec2 A,float B){vec2 C=vec2(sin(B*CLOVER_NOISE_2D_PI*100.),cos(B*CLOVER_NOISE_2D_PI*100.))*floor(B*50.+1.)*.01+.5;return A+C*CLOVER_NOISE_2D_POINT_SPREAD*2.+.5-CLOVER_NOISE_2D_POINT_SPREAD;}float clover_noise_2d(vec2 A){vec2 D=floor(A);vec2 E=clover_noise_2d_offset(D,clover_noise_2d_hash(D));vec2 F=D+vec2(0,-1);F=clover_noise_2d_offset(F,clover_noise_2d_hash(F));vec2 G=D+vec2(0,1);G=clover_noise_2d_offset(G,clover_noise_2d_hash(G));vec2 H=D+vec2(-1,0);H=clover_noise_2d_offset(H,clover_noise_2d_hash(H));vec2 I=D+vec2(1,0);I=clover_noise_2d_offset(I,clover_noise_2d_hash(I));vec2 J=(A-E).yx;vec2 K=J*E;vec2 L=K-J*H;vec2 M=K-J*I;vec2 N,O,P;if((L.y-L.x<0.&&A.x<E.x)||(M.y-M.x>0.&&A.x>=E.x)){vec2 Q=K-J*G;if(Q.y-Q.x>0.){N=G;O=H;P=vec2(-1,1);}else{N=I;O=G;P=vec2(1,1);}}else{vec2 R=K-J*F;if(R.y-R.x>0.){N=F;O=I;P=vec2(1,-1);}else{N=H;O=F;P=vec2(-1,-1);}}P=clover_noise_2d_offset(D+P,clover_noise_2d_hash(D+P));vec2 S=N;vec2 T=O;vec2 U=P;vec2 V=N-O;vec2 W=E-P;if(V.x*V.x+V.y*V.y<W.x*W.x+W.y*W.y){vec2 X=A-N;if(X.x*V.y-X.y*V.x>0.){U=E;}}else{vec2 Y=A-E;if(Y.x*W.y-Y.y*W.x>0.){S=E;}else{T=E;}}vec2 Z=T-S;vec2 a=U-S;vec2 b=A-S;float c=1./(Z.x*a.y-a.x*Z.y);float d=(b.x*a.y-a.x*b.y)*c;float e=(Z.x*b.y-b.x*Z.y)*c;float f=1.-d-e;d=d*d*d;e=e*e*e;f=f*f*f;float g=1./(f+d+e);d*=g;e*=g;f*=g;float h=clover_noise_2d_hash(S);float i=clover_noise_2d_hash(T);float j=clover_noise_2d_hash(U);return f*h+d*i+e*j;}float fractal_clover_noise_2d(vec2 A,int k){float l=0.;float m=0.;float n=1.;float o=1.;for(int p=0;p<10;p++){if(p>=k){break;}l+=clover_noise_2d(A*o)*n;m+=n;n*=.4;o*=2.5;}return l/m;}vec2 curl_clover_noise_2d(vec2 A){const float q=0.01;float d=clover_noise_2d(A);float r=clover_noise_2d(A+vec2(q,0.));float s=clover_noise_2d(A+vec2(0.,q));return normalize(vec2(d-r,d-s));}vec2 curl_fractal_clover_noise_2d(vec2 A,int k){const float q=0.01;float d=fractal_clover_noise_2d(A,k);float r=fractal_clover_noise_2d(A+vec2(q,0.),k);float s=fractal_clover_noise_2d(A+vec2(0.,q),k);return normalize(vec2(d-r,d-s));}