vec3 simplex_noise_2d_permute(vec3 A){return mod(((A*34.)+1.)*A,289.);}float simplex_noise_2d(vec2 B){const vec4 C=vec4(0.211324865405187,0.366025403784439,-0.577350269189626,0.024390243902439);vec2 D=floor(B+dot(B,C.yy));vec2 E=B-D+dot(D,C.xx);vec2 F;F=(E.x>E.y)?vec2(1.,0.):vec2(0.,1.);vec4 G=E.xyxy+C.xxzz;G.xy-=F;D=mod(D,289.);vec3 H=simplex_noise_2d_permute(simplex_noise_2d_permute(D.y+vec3(0.,F.y,1.))+D.x+vec3(0.,F.x,1.));vec3 I=max(0.5-vec3(dot(E,E),dot(G.xy,G.xy),dot(G.zw,G.zw)),0.);I=I*I;I=I*I;vec3 A=2.*fract(H*C.www)-1.;vec3 J=abs(A)-0.5;vec3 K=floor(A+0.5);vec3 L=A-K;I*=1.79284291400159-0.85373472095314*(L*L+J*J);vec3 M;M.x=L.x*E.x+J.x*E.y;M.yz=L.yz*G.xz+J.yz*G.yw;return(130.*dot(I,M))/2.+.5;}float fractal_simplex_noise_2d(vec2 H,int N){float O=0.;float P=0.;float Q=1.;for(int R=0;R<10;R++){if(R>=N){break;}O+=simplex_noise_2d(H/Q)*Q;P+=Q;Q*=.5;}return O/P;}vec2 curl_simplex_noise_2d(vec2 H){const float S=0.01;float B=simplex_noise_2d(H);float A=simplex_noise_2d(H+vec2(S,0.));float T=simplex_noise_2d(H+vec2(0.,S));return normalize(vec2(B-A,B-T));}vec2 curl_fractal_simplex_noise_2d(vec2 H,int N){const float S=0.01;float B=fractal_simplex_noise_2d(H,N);float A=fractal_simplex_noise_2d(H+vec2(S,0.),N);float T=fractal_simplex_noise_2d(H+vec2(0.,S),N);return normalize(vec2(B-A,B-T));}