vec3 RGBtoHSV(vec3 A){float B=max(A.r,max(A.g,A.b));float C=min(A.r,min(A.g,A.b));float D=B-C;vec3 E=vec3(0.,0.,B);if(B>C){E.y=D/B;if(A.r==B)E.x=(A.g-A.b)/D;else{if(A.g==B)E.x=2.+(A.b-A.r)/D;else E.x=4.+(A.r-A.g)/D;}E.x=fract(E.x/6.);}return E;}vec3 HSVtoRGB(vec3 F){vec4 G=vec4(1.,2./3.,1./3.,3.);vec3 H=abs(fract(F.xxx+G.xyz)*6.-G.www);return F.z*mix(G.xxx,clamp(H-G.xxx,0.,1.),F.y);}vec3 RGBtoHSL(vec3 I){vec3 J;float K=min(min(I.r,I.g),I.b);float L=max(max(I.r,I.g),I.b);float D=L-K;J.z=(L+K)/2.;if(D==0.){J.x=0.;J.y=0.;}else{if(J.z<0.5)J.y=D/(L+K);else J.y=D/(2.-L-K);float M=(((L-I.r)/6.)+(D/2.))/D;float N=(((L-I.g)/6.)+(D/2.))/D;float O=(((L-I.b)/6.)+(D/2.))/D;if(I.r==L)J.x=O-N;else if(I.g==L)J.x=(1./3.)+M-O;else if(I.b==L)J.x=(2./3.)+N-M;if(J.x<0.)J.x+=1.;else if(J.x>1.)J.x-=1.;}return J;}vec3 HSLtoRGB(vec3 F){vec3 A=clamp(abs(mod(F.x*6.+vec3(0.,4.,2.),6.)-3.)-1.,0.,1.);return F.z+F.y*(A-0.5)*(1.-abs(2.*F.z-1.));}vec3 RGBtoXYZ(vec3 F){vec3 P;P.x=(F.r>0.04045)?pow((F.r+0.055)/1.055,2.4):F.r/12.92;P.y=(F.g>0.04045)?pow((F.g+0.055)/1.055,2.4):F.g/12.92,P.z=(F.b>0.04045)?pow((F.b+0.055)/1.055,2.4):F.b/12.92;return 100.*P*mat3(0.4124,0.3576,0.1805,0.2126,0.7152,0.0722,0.0193,0.1192,0.9505);}vec3 XYZtoLAB(vec3 F){vec3 Q=F/vec3(95.047,100,108.883);vec3 R;R.x=(Q.x>0.008856)?pow(Q.x,1./3.):(7.787*Q.x)+(16./116.);R.y=(Q.y>0.008856)?pow(Q.y,1./3.):(7.787*Q.y)+(16./116.);R.z=(Q.z>0.008856)?pow(Q.z,1./3.):(7.787*Q.z)+(16./116.);return vec3((116.*R.y)-16.,500.*(R.x-R.y),200.*(R.y-R.z));}vec3 RGBtoLAB(vec3 F){vec3 S=XYZtoLAB(RGBtoXYZ(F));return vec3(S.x/100.,0.5+0.5*(S.y/127.),0.5+0.5*(S.z/127.));}vec3 T(vec3 F){float U=(F.x+16.)/116.;float V=F.y/500.+U;float W=U-F.z/200.;return vec3(95.047*((V>0.206897)?V*V*V:(V-16./116.)/7.787),100.000*((U>0.206897)?U*U*U:(U-16./116.)/7.787),108.883*((W>0.206897)?W*W*W:(W-16./116.)/7.787));}vec3 XYZtoRGB(vec3 F){vec3 R=F/100.*mat3(3.2406,-1.5372,-0.4986,-0.9689,1.8758,0.0415,0.0557,-0.2040,1.0570);vec3 X;X.x=(R.r>0.0031308)?((1.055*pow(R.r,(1./2.4)))-0.055):12.92*R.r;X.y=(R.g>0.0031308)?((1.055*pow(R.g,(1./2.4)))-0.055):12.92*R.g;X.z=(R.b>0.0031308)?((1.055*pow(R.b,(1./2.4)))-0.055):12.92*R.b;return X;}vec3 LABtoRGB(vec3 F){return XYZtoRGB(T(vec3(100.*F.x,2.*127.*(F.y-0.5),2.*127.*(F.z-0.5))));}