vec4 perlin_noise_2d_permute(vec4 A){return mod(((A*34.)+1.)*A,289.);}vec2 perlin_noise_2d_fade(vec2 B){return B*B*B*(B*(B*6.-15.)+10.);}float perlin_noise_2d(vec2 C){vec4 D=floor(C.xyxy)+vec4(0.,0.,1.,1.);vec4 E=fract(C.xyxy)-vec4(0.,0.,1.,1.);D=mod(D,289.);vec4 F=D.xzxz;vec4 G=D.yyww;vec4 H=E.xzxz;vec4 I=E.yyww;vec4 J=perlin_noise_2d_permute(perlin_noise_2d_permute(F)+G);vec4 K=2.*fract(J*0.0243902439)-1.;vec4 L=abs(K)-0.5;vec4 M=floor(K+0.5);K=K-M;vec2 N=vec2(K.x,L.x);vec2 O=vec2(K.y,L.y);vec2 P=vec2(K.z,L.z);vec2 Q=vec2(K.w,L.w);vec4 R=1.79284291400159-0.85373472095314*vec4(dot(N,N),dot(P,P),dot(O,O),dot(Q,Q));N*=R.x;P*=R.y;O*=R.z;Q*=R.w;float S=dot(N,vec2(H.x,I.x));float T=dot(O,vec2(H.y,I.y));float U=dot(P,vec2(H.z,I.z));float V=dot(Q,vec2(H.w,I.w));vec2 W=perlin_noise_2d_fade(E.xy);vec2 X=mix(vec2(S,U),vec2(T,V),W.x);float Y=mix(X.x,X.y,W.y);return(2.3*Y)/2.+.5;}float fractal_perlin_noise_2d(vec2 Z,int a){float b=0.;float c=0.;float d=1.;for(int e=0;e<10;e++){if(e>=a){break;}b+=perlin_noise_2d(Z/d)*d;c+=d;d*=.5;}return b/c;}vec2 curl_perlin_noise_2d(vec2 Z){const float f=0.01;float g=perlin_noise_2d(Z);float A=perlin_noise_2d(Z+vec2(f,0.));float h=perlin_noise_2d(Z+vec2(0.,f));return normalize(vec2(g-A,g-h));}vec2 curl_fractal_perlin_noise_2d(vec2 Z,int a){const float f=0.01;float g=fractal_perlin_noise_2d(Z,a);float A=fractal_perlin_noise_2d(Z+vec2(f,0.),a);float h=fractal_perlin_noise_2d(Z+vec2(0.,f),a);return normalize(vec2(g-A,g-h));}